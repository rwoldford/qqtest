<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title><code>qqtest</code> A self-calibrated quantile-quantile plot for assessing distributional shape. — qqtest • qqtest</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="<code>qqtest</code> A self-calibrated quantile-quantile plot for assessing distributional shape. — qqtest" />
<meta property="og:description" content="Draws a quantile-quantile plot for visually assessing whether the data come
   from a test distribution that has been defined in one of many ways.
The vertical axis plots the data quantiles, the horizontal those of a test distribution.
Interval estimates and exemplars provide different comparative information to assess the
   evidence provided by the qqplot against the hypothesis that the data come from the test distribution
   (default is normal or gaussian).
   Interval estimates provide test information related to individual quantiles,
   exemplars provide test information related to the shape of the quantile quantile curve.
Optionally, a visual test of significance (a lineup plot) can be displayed to provide a
   coarse level of significance for testing the null hypothesis that the data come from the
   test distribution.
The default behaviour generates 1000 samples from the test distribution and overlays the
   plot with pointwise interval estimates for the ordered quantiles from the test distribution.
Various option choices are available to effect different visualizations of the
   uncertainty surrounding the quantile quantile plot.
   These include overlaying independently generated exemplar test distribution sample
   quantile traces so as to assess the joint (as opposed to pointwise) distribution of quantiles.
See argument descriptions and examples for more details." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">qqtest</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/K-distribution.html">The K distribution</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1><code>qqtest</code> A self-calibrated quantile-quantile plot for assessing distributional shape.</h1>
    
    <div class="hidden name"><code>qqtest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Draws a quantile-quantile plot for visually assessing whether the data come
   from a test distribution that has been defined in one of many ways.</p>
<p>The vertical axis plots the data quantiles, the horizontal those of a test distribution.</p>
<p>Interval estimates and exemplars provide different comparative information to assess the
   evidence provided by the qqplot against the hypothesis that the data come from the test distribution
   (default is normal or gaussian).
   Interval estimates provide test information related to individual quantiles,
   exemplars provide test information related to the shape of the quantile quantile curve.</p>
<p>Optionally, a visual test of significance (a lineup plot) can be displayed to provide a
   coarse level of significance for testing the null hypothesis that the data come from the
   test distribution.</p>
<p>The default behaviour generates 1000 samples from the test distribution and overlays the
   plot with pointwise interval estimates for the ordered quantiles from the test distribution.</p>
<p>Various option choices are available to effect different visualizations of the
   uncertainty surrounding the quantile quantile plot.
   These include overlaying independently generated exemplar test distribution sample
   quantile traces so as to assess the joint (as opposed to pointwise) distribution of quantiles.</p>
<p>See argument descriptions and examples for more details.</p>
    </div>

    <pre class="usage"><span class='fu'>qqtest</span>(
  <span class='no'>data</span>,
  <span class='kw'>dist</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"gaussian"</span>, <span class='st'>"normal"</span>, <span class='st'>"log-normal"</span>, <span class='st'>"half-normal"</span>, <span class='st'>"uniform"</span>, <span class='st'>"exponential"</span>,
    <span class='st'>"chi-squared"</span>, <span class='st'>"kay"</span>, <span class='st'>"student"</span>, <span class='st'>"t"</span>),
  <span class='kw'>df</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>qfunction</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>rfunction</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>dataTest</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>p</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>a</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>np</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>matchMethod</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"hinges"</span>, <span class='st'>"quartiles"</span>, <span class='st'>"highbreakdown"</span>),
  <span class='kw'>xAxisAsProbs</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>yAxisAsProbs</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>xAxisProbs</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.05</span>, <span class='fl'>0.25</span>, <span class='fl'>0.5</span>, <span class='fl'>0.75</span>, <span class='fl'>0.95</span>),
  <span class='kw'>yAxisProbs</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.05</span>, <span class='fl'>0.25</span>, <span class='fl'>0.5</span>, <span class='fl'>0.75</span>, <span class='fl'>0.95</span>),
  <span class='kw'>nreps</span> <span class='kw'>=</span> <span class='fl'>1000</span>,
  <span class='kw'>centralPercents</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.9</span>, <span class='fl'>0.95</span>, <span class='fl'>0.99</span>),
  <span class='kw'>envelope</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>drawPercentiles</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>drawQuartiles</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>legend</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>legend.xy</span> <span class='kw'>=</span> <span class='st'>"topleft"</span>,
  <span class='kw'>legend.cex</span> <span class='kw'>=</span> <span class='fl'>0.8</span>,
  <span class='kw'>nexemplars</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>typex</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>plainTrails</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>colTrails</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>alphaTrails</span> <span class='kw'>=</span> <span class='fl'>0.25</span>,
  <span class='kw'>lwdTrails</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>lineup</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>nsuspects</span> <span class='kw'>=</span> <span class='fl'>20</span>,
  <span class='kw'>col</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>h</span> <span class='kw'>=</span> <span class='fl'>260</span>,
  <span class='kw'>c</span> <span class='kw'>=</span> <span class='fl'>90</span>,
  <span class='kw'>l</span> <span class='kw'>=</span> <span class='fl'>60</span>,
  <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>cex</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>pch</span> <span class='kw'>=</span> <span class='fl'>19</span>,
  <span class='kw'>type</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>main</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>xlim</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>ylim</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>axes</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>bty</span> <span class='kw'>=</span> <span class='st'>"o"</span>,
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A univariate dataset to be tested. If data has more than one column, the first is used.</p></td>
    </tr>
    <tr>
      <th>dist</th>
      <td><p>The name of the distribution against which the comparison is made, the test distribution for a few built-in distributions.
  One of <code>"gaussian"</code> (or <code>"normal"</code>), <code>"log normal"</code>,<code>"half normal"</code>,
  <code>"uniform"</code>,<code>"exponential"</code>,<code>"student"</code>, <code>"chi-squared"</code>, or <code>"kay"</code>.
  Only the first three characters of any of these is needed to specify the dist.</p>
<p>If dist is <code>"student"</code>,  <code>"chi-squared"</code>, or <code>"kay"</code>, then a value for the degrees of freedom
  argument (<code>df</code> below) is also required.</p></td>
    </tr>
    <tr>
      <th>df</th>
      <td><p>Degrees of freedom of <code>dist</code> to be used when <code>dist</code> is either <code>"student"</code> or <code>"chi-squared"</code>.</p></td>
    </tr>
    <tr>
      <th>qfunction</th>
      <td><p>If non-<code>NULL</code>, this must be a function of a single argument (a proportion, p say) which will be used
to calculate the quantiles for the test distribution.  If non-<code>NULL</code>, the <code>rfunction</code> should also be non-<code>NULL</code>.
The value of the <code>dist</code> argument will be ignored when this is the case.</p></td>
    </tr>
    <tr>
      <th>rfunction</th>
      <td><p>If non-<code>NULL</code>, this must be a function of a single argument (a count, n say) which will be
used to randomly select a sample of size n from the test distribution.
If non-<code>NULL</code>, the <code>qfunction</code> must also be non-NULL.
If <code>qfunction</code> is non-<code>NULL</code> and  <code>rfunction</code> is <code>NULL</code>, then <code>qfunction</code> will
be applied to the output of a call to <code>runif</code> in place of the <code>NULL</code> <code>rfunction</code>
 (i.e. a probability integral transform is used to generate a random sample).</p>
<p>The value of the <code>dist</code> argument will be ignored whenever <code>qfunction</code> is a function.</p></td>
    </tr>
    <tr>
      <th>dataTest</th>
      <td><p>If non-<code>NULL</code>, this must be a second data set.
The empirical distribution given by this data will be used as the test distribution against which the value of data will be tested.
If non-<code>NULL</code>, the values of the arguments <code>dist</code>, <code>qfunction</code>, and <code>rfunction</code> will all be ignored in
favour of using this empirical distribution as the test distribution.</p></td>
    </tr>
    <tr>
      <th>p</th>
      <td><p>If non-<code>NULL</code>, this must be a vector containing the probability points at which the quantiles are to be calculated.
If the length of this vector is the same as that of the data, then <code>p</code> is taken to be the probabilities that
correspond to the data; otherwise the data are taken to provide and empirical quantile function values of which are
taken at <code>p</code> to produce the plot.</p>
<p>If <code>p</code> is <code>NULL</code> (the default), then <code>p</code> is determined by the function <code><a href='https://rdrr.io/r/stats/ppoints.html'>ppoints(n,a)</a></code>
where <code>n</code> is the number of data points in <code>data</code> and <code>a</code> is given by the argument <code>a</code> below.</p></td>
    </tr>
    <tr>
      <th>a</th>
      <td><p>This is the second parameter given to the <code>ppoints</code> call to determine <code>p</code> as necessary.
If <code>a</code> is <code>NULL</code>, then default values are chosen for each specific distribution
(e.g. 3/8 for gaussian, 0 for uniform, etc.) and as 2/5 otherwise, following the recommendations of C. Cunnane (1978).
Users may supply their own value such as the original Hazen's 1/2 or Tukey's 1/3.</p></td>
    </tr>
    <tr>
      <th>np</th>
      <td><p>This is required if the vector <code>p</code> is provided.
Because <code>p</code> could take any values, we need to know <code>np</code> the sample size that was used  to construct the
quantiles at the provided vlaues <code>p</code>.
When <code>p</code> and <code>np</code> are provided all simulation is based on simulating values from the distribution of
the order statistics <code>p*np</code>.</p></td>
    </tr>
    <tr>
      <th>matchMethod</th>
      <td><p>It is necessary to match locations and scales of the two distributions.  The method used to do this matching
is given by <code>matchMethod</code> which must be one of <code><a href='https://rdrr.io/r/base/c.html'>c("hinges","quartiles")</a></code>.
A line is fitted to the data and its coefficients used to adjust the location and scale of the test quantiles to match the data.</p>
<p>If <code>matchMethod = "hinges"</code> (the default), then the line is fit to <code>(x, y)</code> pairs given by the three central values of
<code><a href='https://rdrr.io/r/stats/fivenum.html'>fivenum()</a></code> on each of the coordinates; if "quartiles" the three quartiles of each coordinate are paired and a line fit.</p>
<p>Note that the user may supply their own matching method by providing a function having vector arguments <code>x</code> and <code>y</code>
for the horizontal and vertical quantiles which returns a vector of coefficients (intercept, slope) for the line to be used to match
the quantile location and scales.</p></td>
    </tr>
    <tr>
      <th>xAxisAsProbs</th>
      <td><p>If <code>TRUE</code> (the default is FALSE) the horizontal axis will be labelled as probabilities.
These are the cumulative probabilities according to the test distribution.  They are located at the corresponding quantile values.
They are handy in comparing percentiles of the test and data distributions as well as giving some measure of the symmetry and
tail weights of the test distribution by their location.
If <code>FALSE</code> the axis is labelled according to the quantile values.</p></td>
    </tr>
    <tr>
      <th>yAxisAsProbs</th>
      <td><p>If <code>TRUE</code> (the default is FALSE) the vertical axis will be labelled as probabilities.
These are the cumulative probabilities according to the empirical distribution of the <code>data</code>.
They are located at the corresponding quantile values.
They are handy in comparing percentiles of the test and data distributions as well as giving
some measure of the symmetry and tail weights of the <code>data</code> distribution by their location.
If <code>FALSE</code> the axis is labelled according to the quantile values.</p></td>
    </tr>
    <tr>
      <th>xAxisProbs</th>
      <td><p>A vector of probabilities to be used to label the x axis ticks when <code>xAxisAsProbs</code> is <code>TRUE</code>.
Default is <code><a href='https://rdrr.io/r/base/c.html'>c(0.05, 0.25, 0.50, 0.75, 0.95)</a></code>.  Ignored if <code>xAxisAsProbs</code> is <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>yAxisProbs</th>
      <td><p>A vector of probabilities to be used to label the y axis ticks when <code>yAxisAsProbs</code> is <code>TRUE</code>.
Default is <code><a href='https://rdrr.io/r/base/c.html'>c(0.05, 0.25, 0.50, 0.75, 0.95)</a></code>.  Ignored if <code>yAxisAsProbs</code> is <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>nreps</th>
      <td><p>The number of replicate samples to be taken from the test distribution to construct the pointwise intervals
for each quantile.  Default is 1000.
From these samples, an empirical distribution is generated from the test distribution for the ordered quantiles
corresponding to the values of<code><a href='https://rdrr.io/r/stats/ppoints.html'>ppoints(length(data))</a></code>.
These are used to construct central intervals of whatever proportions are given by <code>centralPercents</code>.</p></td>
    </tr>
    <tr>
      <th>centralPercents</th>
      <td><p>The vector of proportions determining the central intervals of the empirical distribution of
each ordered quantile from the test distribution.
Default is <code><a href='https://rdrr.io/r/base/c.html'>c(0.90, 0.95, 0.99)</a></code> corresponding to central 90, 95, and 99% simulated pointwise confidence
intervals for each quantile coming from the test distribution for a sample the same size as <code>data</code>.
The quality of these interval locations typically increases with <code>nreps</code> and decreases with the
probability used for each interval.</p></td>
    </tr>
    <tr>
      <th>envelope</th>
      <td><p>If <code>TRUE</code> (the default), a grey envelope is plotted showing the central intervals for
each quantile as a shade of grey.  The higher is the corresponding probability associated with the interval,
the lighter is the shade.
The outermost edges of the envelope are the range of the simulated data from the test distribution.
The envelope thus provides a (pointwise) density estimate of the quantiles drawn from the test distribution for this sample size.
If <code>FALSE</code> no envelope is drawn.</p></td>
    </tr>
    <tr>
      <th>drawPercentiles</th>
      <td><p>If <code>TRUE</code>, a pair of curves is plotted to show each of the central intervals as a different line type.
These are plotted over the envelope if <code>envelope</code> is <code>TRUE</code>.
If <code>FALSE</code> (the default) no simulated percentile curves are drawn.</p></td>
    </tr>
    <tr>
      <th>drawQuartiles</th>
      <td><p>If <code>TRUE</code>, a pair of curves is plotted to show the quartiles (central 50% region)
of the ordered quantiles simulated from the test distribution.  The median of these is also plotted as a solid line type.
These are plotted over the envelope if <code>envelope</code> is <code>TRUE</code>.
If <code>FALSE</code> (the default) none of these curves are drawn.</p></td>
    </tr>
    <tr>
      <th>legend</th>
      <td><p>If <code>TRUE</code> (the default is <code>NULL</code>) with <code>nreps&gt;0</code> a legend for the appearance
of the simulated ranges of the central intervals is added to the plot.
If <code>FALSE</code>, no legend appears. If <code>NULL</code>, legend always appears except when <code>lineup = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>legend.xy</th>
      <td><p>Either a string being one of <code><a href='https://rdrr.io/r/base/c.html'>c("bottomright", "bottom", "bottomleft", "left", "topleft","top", "topright", "right", "center")</a></code>
 (default is <code>"topleft"</code>) or a list with named components <code>x</code> and <code>y</code>
to be interpreted exactly as in the function <code><a href='https://rdrr.io/r/graphics/legend.html'>legend()</a></code> from the <code>graphics</code> package.</p></td>
    </tr>
    <tr>
      <th>legend.cex</th>
      <td><p>Character expansion size for legend (default 0.8).</p></td>
    </tr>
    <tr>
      <th>nexemplars</th>
      <td><p>(default is 0) The number of replicate samples to be taken from the test distribution and
plotted as a coloured trail on the qqplot.
Each such trail is a sample of the same size as <code>data</code> but truly coming from the test distribution.
Each trail gives some idea of what the shape of a qqplot would be for a sample of that size from the test distribution.
Together, they give some sense of the variability in the plot's shape.</p></td>
    </tr>
    <tr>
      <th>typex</th>
      <td><p>(default is "o", or match <code>type</code> if supplied) The <code>plot</code> type to be used in the
plotting of the exemplars, legal values are the same as for the  <code>type</code> argument of <code>plot</code>.</p></td>
    </tr>
    <tr>
      <th>plainTrails</th>
      <td><p>If <code>TRUE</code>, then a single grey colour is used for all exemplar trails.
If <code>FALSE</code> (the default), each exemplar trail is shown in a different colour.</p></td>
    </tr>
    <tr>
      <th>colTrails</th>
      <td><p>Colours to be used for the trails (default will be multi-colours).</p></td>
    </tr>
    <tr>
      <th>alphaTrails</th>
      <td><p>The alpha transparency to be used in plotting all exemplar trails. The default is 0.25.
Because the trails will overplot, a smaller <code>alphaTrails</code> value is recommended as <code>nexemplars</code> increases.</p></td>
    </tr>
    <tr>
      <th>lwdTrails</th>
      <td><p>The graphical line width (<code>lwd</code>) to be used in plotting all exemplar trails.   The default is 1.
Because the trails will overplot, combining a larger <code>lwdTrails</code> with <code>envelope = FALSE</code>,
a lower <code>alphaTrails</code> value larger <code>nexemplars</code> can give a truer sense of the density of qqplot
configurations than with <code>envelope = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>lineup</th>
      <td><p>If <code>TRUE</code> (default is <code>FALSE</code>) the qqplot of <code>data</code> is randomly located in a
grid of <code>nsuspects</code> plots.  Identical arguments are given to construct all <code>qqtest</code> plots in the grid.
Assuming the viewer has not seen the qqplot of this <code>data</code> before, a successful selection of the true <code>data</code>
plot out of the grid of plots corresponds to evidence against the hypothesis that the <code>data</code> come from the test distribution.
Significance level is 1/<code>nsuspects</code>.
Similarly, if the viewer narrows the selection down to only k possible subjects AND the true location is among them, then
the corresponding observed level of significance (p-value) would be k//<code>nsuspects</code>.</p>
<p>Each plot is given a suspect number from 1 to <code>nsuspects</code> (left to right, top to bottom).
The suspect number of the plot corresponding to the actual <code>data</code> is returned, slightly obfuscated to help keep the test honest.</p></td>
    </tr>
    <tr>
      <th>nsuspects</th>
      <td><p>The total number of plots (default is 20) to be viewed in the lineup display when <code>lineup</code> is <code>lineup</code>.</p></td>
    </tr>
    <tr>
      <th>col</th>
      <td><p>If non-<code>NULL</code>, <code>col</code> must be colour to be used for the points in the plot.  If <code>NULL</code> (the default), an <code>hcl</code> colour will be used from the values of the arguments <code>h</code>, <code>c</code>, <code>l</code>, and <code>alpha</code>.</p></td>
    </tr>
    <tr>
      <th>h</th>
      <td><p>The hue of the colour of the points.  Specified as an angle in degrees from 0 to 360 around a colour wheel.  E.g. 0 is red, 120 green, 240 blue,  Default is 260 (a bluish).</p></td>
    </tr>
    <tr>
      <th>c</th>
      <td><p>The chroma of the colour of the points.  Takes values from 0 to an upper bound that is a function of hue, <code>h</code>,  and luminance, <code>l</code>.  Roughly, for fixed <code>h</code> and <code>l</code> the higher the value of <code>c</code> the greater the intensity of colour.</p></td>
    </tr>
    <tr>
      <th>l</th>
      <td><p>The luminance of the colour of the points.  Takes values from 0 to 100. For any given combination of hue, <code>h</code>,  and chroma, <code>c</code>, only a subset of this range will be possible.  Roughly, for fixed <code>h</code> and <code>c</code> the higher the value of <code>l</code> the lighter is the colour.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>The alpha transparency of the colour of the points.  Takes values from 0 to 1. Values near 0 are more transparent, values near 1 (the default) are more opaque. Alpha values sum when points over plot, giving some indication of density.</p></td>
    </tr>
    <tr>
      <th>cex</th>
      <td><p>The graphical parameter <code>cex</code> for the size of the points.</p></td>
    </tr>
    <tr>
      <th>pch</th>
      <td><p>The graphical parameter <code>pch</code> for the point character to be used for the points.  Default is 19, a filled circle.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>The graphical parameter <code>type</code> for the points of the qqplot. Default is "p".</p></td>
    </tr>
    <tr>
      <th>main</th>
      <td><p>The graphical parameter <code>main</code> providing a title for the plot.
If <code>NULL</code> (the default), the title will be "qqtest" when <code>lineup = FALSE</code> and "Suspect: " followed by
the plot number when <code>lineup = TRUE</code>.  An empty string will suppress the title.</p></td>
    </tr>
    <tr>
      <th>xlab</th>
      <td><p>The graphical parameter <code>xlab</code> labelling the x axis of the plot.
If <code>NULL</code> (the default), an <code>xlab</code> is created based on the information available from the
other arguments to <code>qqtest</code> about the test distribution.  An empty string will suppress the labelling.</p></td>
    </tr>
    <tr>
      <th>ylab</th>
      <td><p>The graphical parameter <code>ylab</code> labelling the y axis of the plot.
If <code>NULL</code> (the default), a <code>ylab</code> is created based on the information available from the other
arguments to <code>qqtest</code>. An empty string will suppress the labelling.</p></td>
    </tr>
    <tr>
      <th>xlim</th>
      <td><p>The graphical parameter <code>xlim</code> determining the display limits of the x axis.</p></td>
    </tr>
    <tr>
      <th>ylim</th>
      <td><p>The graphical parameter <code>ylim</code> determining the display limits of the y axis.</p></td>
    </tr>
    <tr>
      <th>axes</th>
      <td><p>The graphical parameter <code>axes</code> determining whether axes are to be displayed
(default is <code>NULL</code> which the same as <code>TRUE</code> except when <code>lineup=TRUE</code>, then <code>axes</code> is <code>FALSE</code>).</p></td>
    </tr>
    <tr>
      <th>bty</th>
      <td><p>The graphical parameter <code>bty</code> determining the type of box to be used to
enclose the plot (default is <code>"o"</code>, set <code>bty="n"</code> for no box).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Any further graphical parameters to be passed to the <code>plot</code> function.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="source"><a class="anchor" href="#source"></a>Source</h2>

    <p>"Self calibrating quantile-quantile plots",
R. Wayne Oldford, The American Statistician, 70, (2016)
<a href='https://doi.org/10.1080/00031305.2015.1090338'>https://doi.org/10.1080/00031305.2015.1090338</a></p>
<p>"Unbiased Plotting Positions -- A Review",
C. Cunnane, Journal of Hydrology, Vol. 37 (1978), pp. 205-222.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Displays the qqplot.</p>
<p>Invisibly returns a list with named components <code>x</code> and <code>y</code> giving the horizontal and
vertical locations of the points in order.  The result of <code>qqtest</code> must be assigned to get these.
The calues could then be used to identify or label points in the display.</p>
<p>When <code>lineup</code> is <code>TRUE</code>, it returns a string encoding
the true location of the data as a calculation to be evaluated.  This provides some simple obfuscation of the true
location so that the visual assessment can be honest.  The true location is revealed by calling <code>revealLocation()</code>
on the returned value.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#</span>
<span class='co'># default qqtest plot</span>
<span class='fu'>qqtest</span>(<span class='no'>precip</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Precipitation (inches/year) in 70 US cities"</span>)</div><div class='img'><img src='qqtest-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>#</span>
<span class='co'># qqtest to compare to qqnorm</span>
<span class='no'>op</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mfrow</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>))
<span class='fu'><a href='https://rdrr.io/r/stats/qqnorm.html'>qqnorm</a></span>(<span class='no'>precip</span>, <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"qqnorm"</span>)
<span class='fu'>qqtest</span>(<span class='no'>precip</span>, <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"qqtest"</span>,
       <span class='kw'>xAxisAsProbs</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>yAxisAsProbs</span><span class='kw'>=</span><span class='fl'>FALSE</span>)</div><div class='img'><img src='qqtest-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='no'>op</span>)
<span class='co'>#</span>
<span class='co'>#  Use lines instead of envelope</span>
<span class='fu'>qqtest</span>(<span class='no'>precip</span>, <span class='kw'>envelope</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>drawPercentiles</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
       <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Precipitation (inches/year) in 70 US cities"</span>)</div><div class='img'><img src='qqtest-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>#</span>
<span class='co'>#  Use quartiles instead of envelope</span>
<span class='fu'>qqtest</span>(<span class='no'>precip</span>, <span class='kw'>envelope</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>drawQuartiles</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
       <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Precipitation (inches/year) in 70 US cities"</span>)</div><div class='img'><img src='qqtest-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>#</span>
<span class='co'>#  Use coloured exemplars (qqplot of data simulated from the test distribution)</span>
<span class='co'>#  and suppress the envelope.  Where the envelope, percentiles, and quartiles are</span>
<span class='co'>#  simulated pointwise bands, exemplars give some sense of what the (joint) shape of the</span>
<span class='co'>#  quantile-quantile plot should look like (for data from the test distribution).</span>
<span class='co'>#  Each simulated sample is a different colour.</span>
<span class='fu'>qqtest</span>(<span class='no'>precip</span>, <span class='kw'>nexemplars</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>typex</span><span class='kw'>=</span><span class='st'>"o"</span>, <span class='kw'>envelope</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"p"</span>,
       <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Precipitation (inches/year) in 70 US cities"</span>)</div><div class='img'><img src='qqtest-5.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>#</span>
<span class='co'>#  Alternatively, the trail of each exemplar could be plain (the identical grey).</span>
<span class='co'>#  Making each trail wide and assigning it some transparency (alpha near 0)</span>
<span class='co'>#  allows the trails to give a sense of the density through the darkness of the grey.</span>
<span class='co'>#</span>
<span class='fu'>qqtest</span>(<span class='no'>precip</span>, <span class='kw'>nexemplars</span><span class='kw'>=</span><span class='fl'>20</span>, <span class='kw'>envelope</span><span class='kw'>=</span><span class='fl'>FALSE</span>,
       <span class='kw'>lwdTrails</span><span class='kw'>=</span><span class='fl'>3</span>, <span class='kw'>plainTrails</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>alphaTrail</span><span class='kw'>=</span><span class='fl'>0.4</span>, <span class='kw'>typex</span><span class='kw'>=</span><span class='st'>"o"</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"o"</span>,
       <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Precipitation (inches/year) in 70 US cities"</span>)</div><div class='img'><img src='qqtest-6.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>#</span>
<span class='co'>#  Wide coloured exemplars with some transparency provide an indication of</span>
<span class='co'>#  density and allow some trails to be followed by colour.</span>
<span class='co'>#</span>
<span class='fu'>qqtest</span>(<span class='no'>precip</span>, <span class='kw'>nexemplars</span><span class='kw'>=</span><span class='fl'>20</span>, <span class='kw'>envelope</span><span class='kw'>=</span><span class='fl'>FALSE</span>,
       <span class='kw'>lwdTrails</span><span class='kw'>=</span><span class='fl'>3</span>,  <span class='kw'>alphaTrail</span><span class='kw'>=</span><span class='fl'>0.4</span>, <span class='kw'>typex</span><span class='kw'>=</span><span class='st'>"o"</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"o"</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"black"</span>,
       <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Precipitation (inches/year) in 70 US cities"</span>)</div><div class='img'><img src='qqtest-7.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='co'>#  Envelope and exemplars with coloured trails to be followed.</span>
<span class='co'>#</span>
<span class='fu'>qqtest</span>(<span class='no'>precip</span>, <span class='kw'>nexemplars</span><span class='kw'>=</span><span class='fl'>5</span>,
       <span class='kw'>lwdTrails</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>alphaTrail</span><span class='kw'>=</span><span class='fl'>0.6</span>, <span class='kw'>alpha</span><span class='kw'>=</span><span class='fl'>0.8</span>,
       <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Precipitation (inches/year) in 70 US cities"</span>)</div><div class='img'><img src='qqtest-8.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>#</span>
<span class='co'>#</span>
<span class='co'>#  gaussian - qqplot, but now showing in the line up</span>
<span class='no'>trueLoc</span> <span class='kw'>&lt;-</span> <span class='fu'>qqtest</span>(<span class='no'>precip</span>, <span class='kw'>lineup</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"Suspect"</span>, <span class='kw'>legend</span><span class='kw'>=</span><span class='fl'>FALSE</span>,
                  <span class='kw'>cex</span><span class='kw'>=</span><span class='fl'>0.75</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"grey20"</span>, <span class='kw'>ylab</span><span class='kw'>=</span><span class='st'>""</span>, <span class='kw'>pch</span><span class='kw'>=</span><span class='fl'>21</span>)</div><div class='img'><img src='qqtest-9.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># the location of the real data in the line up can be found by evaluating</span>
<span class='co'># the contents of the string</span>
<span class='no'>trueLoc</span></div><div class='output co'>#&gt; [1] "2^(log(78123371961212.7, base=29) - 6.5)"</div><div class='input'><span class='co'>#</span>
<span class='co'># Cut and paste the string contents into the R console, or simply</span>
<span class='fu'>revealLocation</span>(<span class='no'>trueLoc</span>)</div><div class='output co'>#&gt; [1] 8</div><div class='input'><span class='co'>#</span>
<span class='co'>#</span>
<span class='co'># log-normal ... using the bacteria data from Whipple(1916)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>bacteria</span>, <span class='kw'>package</span><span class='kw'>=</span><span class='st'>"qqtest"</span>)
<span class='co'># Note that these are selected percentiles from a sample of 365 days in a year</span>
<span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span>(<span class='no'>bacteria</span>,
    <span class='fu'>qqtest</span>(<span class='no'>count</span>, <span class='kw'>dist</span> <span class='kw'>=</span> <span class='st'>"log-normal"</span>, <span class='kw'>p</span><span class='kw'>=</span><span class='no'>percentTime</span>/<span class='fl'>100</span>, <span class='kw'>np</span><span class='kw'>=</span><span class='fl'>365</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"o"</span>,
                  <span class='kw'>yAxisAsProbs</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>ylab</span><span class='kw'>=</span><span class='st'>"bacteria per cc"</span>,
           <span class='kw'>xAxisProbs</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.01</span>, <span class='fl'>0.50</span>,<span class='fl'>0.75</span>, <span class='fl'>0.90</span>, <span class='fl'>0.95</span>, <span class='fl'>0.99</span>, <span class='fl'>0.995</span>),
           <span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>"Percentage of days in 1913"</span>,
           <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Number of bacteria from the Delaware river in 1913"</span>)
    )</div><div class='input'><span class='no'>ptics</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.01</span>, <span class='fl'>0.10</span>, <span class='fl'>0.25</span>, <span class='fl'>0.50</span>, <span class='fl'>0.75</span>, <span class='fl'>0.90</span>, <span class='fl'>0.99</span> )
<span class='fu'><a href='https://rdrr.io/r/graphics/axis.html'>axis</a></span>(<span class='fl'>1</span>,<span class='kw'>at</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>qnorm</a></span>(<span class='no'>ptics</span>), <span class='kw'>labels</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>floor</a></span>(<span class='no'>ptics</span>*<span class='fl'>100</span>))</div><div class='input'><span class='no'>yvals</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>100</span>, <span class='fl'>1000</span>, <span class='fl'>10000</span>, <span class='fl'>100000</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/axis.html'>axis</a></span>(<span class='fl'>2</span>, <span class='kw'>at</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span>(<span class='no'>yvals</span>,<span class='fl'>10</span>),
     <span class='kw'>labels</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"100"</span>, <span class='st'>"1,000"</span>, <span class='st'>"10,000"</span>, <span class='st'>"100,000"</span>))</div><div class='img'><img src='qqtest-10.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>#</span>
<span class='co'># compare this to the log-scaled normal qqplot</span>
<span class='co'>#</span>
<span class='co'>#</span>
<span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span>(<span class='no'>bacteria</span>,
    <span class='fu'>qqtest</span>(<span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span>(<span class='no'>count</span>, <span class='fl'>10</span>), <span class='kw'>dist</span> <span class='kw'>=</span> <span class='st'>"normal"</span>,
           <span class='kw'>p</span><span class='kw'>=</span><span class='no'>percentTime</span>/<span class='fl'>100</span>, <span class='kw'>np</span><span class='kw'>=</span><span class='fl'>365</span>,
                  <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"o"</span>, <span class='kw'>axes</span><span class='kw'>=</span><span class='fl'>FALSE</span>,
           <span class='kw'>ylab</span><span class='kw'>=</span><span class='st'>"bacteria per cc"</span>,
           <span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>"Proportion of days in 1913"</span>,
           <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Number of bacteria from the Delaware river in 1913"</span>)
    )</div><div class='img'><img src='qqtest-11.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>#</span>
<span class='co'>#</span>
<span class='co'># Half normal ... using the penicillin data from Daniel(1959)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>penicillin</span>)

<span class='fu'>qqtest</span>(<span class='no'>penicillin</span>, <span class='kw'>dist</span> <span class='kw'>=</span> <span class='st'>"half-normal"</span>)</div><div class='img'><img src='qqtest-12.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Or the same again but with significant contrast labelled</span>


<span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span> (<span class='no'>penicillin</span>,
        {<span class='fu'>qqtest</span>(<span class='no'>value</span>, <span class='kw'>yAxisProbs</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.1</span>, <span class='fl'>0.75</span>, <span class='fl'>0.90</span>, <span class='fl'>0.95</span>),
         <span class='kw'>dist</span><span class='kw'>=</span><span class='st'>"half-normal"</span>,
                        <span class='kw'>ylab</span><span class='kw'>=</span><span class='st'>"Sample cumulative probability"</span>,
         <span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>"Half-normal cumulative probability"</span>)
         <span class='no'>ppAdj</span> <span class='kw'>&lt;-</span> (<span class='fl'>1</span>+<span class='fu'><a href='https://rdrr.io/r/stats/ppoints.html'>ppoints</a></span>(<span class='fl'>31</span>))/<span class='fl'>2</span>  <span class='co'># to get half-normals from normal</span>
         <span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>qnorm</a></span>(<span class='no'>ppAdj</span>)
         <span class='no'>valOrder</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span>(<span class='no'>value</span>)    <span class='co'># need data and rownames in increasing order</span>
         <span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='no'>value</span>[<span class='no'>valOrder</span>]
         <span class='no'>tags</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span>(<span class='no'>penicillin</span>)[<span class='no'>valOrder</span>]
         <span class='no'>selPoints</span> <span class='kw'>&lt;-</span> <span class='fl'>28</span>:<span class='fl'>31</span>          <span class='co'># going to label only the largest effects</span>
  <span class='no'>xoffset</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.01</span>, <span class='fl'>0.02</span>, <span class='fl'>0.03</span>, <span class='fl'>0.075</span>)  <span class='co'># text function is a bit off</span>
         <span class='fu'><a href='https://rdrr.io/r/graphics/text.html'>text</a></span>(<span class='no'>x</span>[<span class='no'>selPoints</span>]-<span class='no'>xoffset</span>, <span class='no'>y</span>[<span class='no'>selPoints</span>],
       <span class='no'>tags</span>[<span class='no'>selPoints</span>],
       <span class='kw'>pos</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>cex</span><span class='kw'>=</span><span class='fl'>0.75</span>)
        }
)</div><div class='img'><img src='qqtest-13.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Alternatively, use the returned results for a lot less work</span>
<span class='no'>results</span> <span class='kw'>&lt;-</span> <span class='fu'>qqtest</span>(<span class='no'>penicillin</span>$<span class='no'>value</span>, <span class='kw'>yAxisProbs</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.1</span>, <span class='fl'>0.75</span>, <span class='fl'>0.90</span>, <span class='fl'>0.95</span>),
                     <span class='kw'>dist</span><span class='kw'>=</span><span class='st'>"half-normal"</span>,
                     <span class='kw'>ylab</span><span class='kw'>=</span><span class='st'>"Sample cumulative probability"</span>,
                     <span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>"Half-normal cumulative probability"</span>)</div><div class='input'><span class='no'>tags</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/row.names.html'>row.names</a></span>(<span class='no'>penicillin</span>)[<span class='no'>results</span>$<span class='no'>order</span>]
<span class='no'>selPoints</span> <span class='kw'>&lt;-</span> <span class='fl'>28</span>:<span class='fl'>31</span>          <span class='co'># going to label only the largest effects</span>
<span class='no'>xoffset</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.01</span>, <span class='fl'>0.02</span>, <span class='fl'>0.03</span>, <span class='fl'>0.075</span>)  <span class='co'># text function is a bit off</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/text.html'>text</a></span>(<span class='no'>results</span>$<span class='no'>x</span>[<span class='no'>selPoints</span>]-<span class='no'>xoffset</span>, <span class='no'>results</span>$<span class='no'>y</span>[<span class='no'>selPoints</span>],
     <span class='no'>tags</span>[<span class='no'>selPoints</span>],
     <span class='kw'>pos</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>cex</span><span class='kw'>=</span><span class='fl'>0.75</span>)</div><div class='img'><img src='qqtest-14.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># or the same points could have been identified interactively vusing</span>
<span class='co'># identify(results$x, results$y, labels = row.names(penicillin)[results$order])</span>
<span class='co'>#</span>
<span class='co'># K on 9 df  ... see help(dkay)</span>
<span class='co'># Use data on primer paint thickness (standard deviations on n=10)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>primer</span>, <span class='kw'>package</span><span class='kw'>=</span><span class='st'>"qqtest"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span> (<span class='no'>primer</span>,
             <span class='fu'>qqtest</span>(<span class='no'>s</span>,  <span class='kw'>dist</span><span class='kw'>=</span><span class='st'>"kay"</span>, <span class='kw'>df</span><span class='kw'>=</span><span class='fl'>9</span>,
                        <span class='kw'>yAxisAsProbs</span><span class='kw'>=</span><span class='fl'>FALSE</span>,
                            <span class='kw'>ylab</span><span class='kw'>=</span><span class='st'>"Standard deviation of primer thickness (in mils)"</span>)
                )</div><div class='img'><img src='qqtest-15.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>#</span>
<span class='co'># chi-squared on 3 df</span>
<span class='co'># Use robust covariance matrix in calculation Mahalanobis distances</span>
<span class='co'># for the classical Brownlee stackloss data.</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>stacklossDistances</span>, <span class='kw'>package</span><span class='kw'>=</span><span class='st'>"qqtest"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span>(<span class='no'>stacklossDistances</span>,
     <span class='fu'>qqtest</span>(<span class='no'>robust</span>, <span class='kw'>dist</span><span class='kw'>=</span><span class='st'>"chi"</span>, <span class='kw'>df</span><span class='kw'>=</span><span class='fl'>3</span>, <span class='kw'>ylab</span><span class='kw'>=</span><span class='st'>"Robust Mahalanobis distances"</span>))</div><div class='img'><img src='qqtest-16.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>#</span>
<span class='co'>#</span>
<span class='co'># user supplied qfunction and rfunction -- compare to beta distribution</span>
<span class='fu'>qqtest</span>(<span class='no'>precip</span>,
       <span class='kw'>qfunction</span><span class='kw'>=</span><span class='kw'>function</span>(<span class='no'>p</span>){<span class='fu'><a href='https://rdrr.io/r/stats/Beta.html'>qbeta</a></span>(<span class='no'>p</span>, <span class='fl'>2</span>, <span class='fl'>2</span>)},
       <span class='kw'>rfunction</span><span class='kw'>=</span><span class='kw'>function</span>(<span class='no'>n</span>){<span class='fu'><a href='https://rdrr.io/r/stats/Beta.html'>rbeta</a></span>(<span class='no'>n</span>, <span class='fl'>2</span>, <span class='fl'>2</span>)},
       <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Precipitation (inches/year) in 70 US cities"</span>)</div><div class='img'><img src='qqtest-17.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>#</span>
<span class='co'>#</span>
<span class='co'># user supplied qfunction only -- compare to beta distribution</span>
<span class='fu'>qqtest</span>(<span class='no'>precip</span>,
       <span class='kw'>qfunction</span><span class='kw'>=</span><span class='kw'>function</span>(<span class='no'>p</span>){<span class='fu'><a href='https://rdrr.io/r/stats/Beta.html'>qbeta</a></span>(<span class='no'>p</span>, <span class='fl'>2</span>, <span class='fl'>2</span>)},
       <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Precipitation (inches/year) in 70 US cities"</span>)</div><div class='img'><img src='qqtest-18.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>#</span>
<span class='co'># comparing data samples</span>
<span class='co'>#</span>
<span class='co'># Does the sample of beaver2's temperatures look like they</span>
<span class='co'># could have come from a distribution shaped like beaver1's?</span>
<span class='co'>#</span>
        <span class='fu'>qqtest</span>(<span class='no'>beaver2</span>[,<span class='st'>"temp"</span>],
                       <span class='kw'>dataTest</span><span class='kw'>=</span><span class='no'>beaver1</span>[,<span class='st'>"temp"</span>],
                       <span class='kw'>ylab</span><span class='kw'>=</span><span class='st'>"Beaver 2"</span>, <span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>"Beaver 1"</span>,
                       <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"Beaver body temperatures"</span>)</div><div class='img'><img src='qqtest-19.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>#</span>
<span class='co'>#</span>
<span class='co'># For the famous iris data, does the sample of iris versicolor</span>
<span class='co'># appear to have the same (marginal) distributional shape</span>
<span class='co'># as does that of iris virginica (to which it is more closely related)?</span>
<span class='co'>#</span>
<span class='no'>op</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mfrow</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>2</span>))
<span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span>(<span class='no'>iris</span>, {
        <span class='fu'>qqtest</span>(<span class='no'>Sepal.Length</span>[<span class='no'>Species</span><span class='kw'>==</span><span class='st'>"versicolor"</span>],
                   <span class='kw'>dataTest</span><span class='kw'>=</span> <span class='no'>Sepal.Length</span>[<span class='no'>Species</span><span class='kw'>==</span><span class='st'>"virginica"</span>],
                   <span class='kw'>ylab</span><span class='kw'>=</span><span class='st'>"versicolor"</span>, <span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>"virginica"</span>,
                   <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"Sepal length"</span>)
        <span class='fu'>qqtest</span>(<span class='no'>Sepal.Width</span>[<span class='no'>Species</span><span class='kw'>==</span><span class='st'>"versicolor"</span>],
                   <span class='kw'>dataTest</span><span class='kw'>=</span> <span class='no'>Sepal.Width</span>[<span class='no'>Species</span><span class='kw'>==</span><span class='st'>"virginica"</span>],
                   <span class='kw'>ylab</span><span class='kw'>=</span><span class='st'>"versicolor"</span>, <span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>"virginica"</span>,
                   <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"Sepal width"</span>, <span class='kw'>legend</span><span class='kw'>=</span><span class='fl'>FALSE</span>)
        <span class='fu'>qqtest</span>(<span class='no'>Petal.Length</span>[<span class='no'>Species</span><span class='kw'>==</span><span class='st'>"versicolor"</span>],
                   <span class='kw'>dataTest</span><span class='kw'>=</span><span class='no'>Petal.Length</span>[<span class='no'>Species</span><span class='kw'>==</span><span class='st'>"virginica"</span>],
                   <span class='kw'>ylab</span><span class='kw'>=</span><span class='st'>"versicolor"</span>, <span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>"virginica"</span>,
                   <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"Petal length"</span>, <span class='kw'>legend</span><span class='kw'>=</span><span class='fl'>FALSE</span>)
        <span class='fu'>qqtest</span>(<span class='no'>Petal.Width</span>[<span class='no'>Species</span><span class='kw'>==</span><span class='st'>"versicolor"</span>],
                   <span class='kw'>dataTest</span><span class='kw'>=</span> <span class='no'>Petal.Width</span>[<span class='no'>Species</span><span class='kw'>==</span><span class='st'>"virginica"</span>],
                   <span class='kw'>ylab</span><span class='kw'>=</span><span class='st'>"versicolor"</span>, <span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>"virginica"</span>,
                   <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"Petal width"</span>, <span class='kw'>legend</span><span class='kw'>=</span><span class='fl'>FALSE</span>)
        }
        )</div><div class='img'><img src='qqtest-20.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='no'>op</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#source">Source</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Wayne Oldford.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


